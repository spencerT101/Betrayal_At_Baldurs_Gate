(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["CreateMenuModalsCommon",732],{"WxW/":function(e,t,i){i.r(t),i.d(t,"default",(function(){return y}));var r=i("q1tI"),a=i("kugi"),n=i("TgLd"),o=i("yweb"),s=i("n6mq"),l=i("nKUr");function c({onDismiss:e}){const t=Object(o.c)();return Object(l.jsx)(n.b,{accessibilityModalLabel:t._("View Bug Report Submission Status","reportBugFailure.modalAccessibilityLabel","Accessibility label for modal shown after failing to submit a bug report"),heading:t._("Oops!","reportBugFailure.modalHeading","Heading for modal shown after failing to submit a bug report"),onDismiss:e,children:Object(l.jsx)(s.f,{paddingX:4,paddingY:4,children:Object(l.jsx)(s.cb,{children:t._("Something went wrong and we were unable to report your bug. We’re looking into it!","reportBugFailure.bodyText","Message shown after failing to submit a bug report")})})})}function d({onDismiss:e}){const t=Object(o.c)();return Object(l.jsx)(n.b,{accessibilityModalLabel:t._("View Bug Report Submission Status","reportBugSuccess.modalAccessibilityLabel","Accessibility label for modal shown after submitting a bug report"),heading:t._("Bug Reported!","reportBugSuccess.modalHeading","Heading for modal shown after submitting a bug report"),onDismiss:e,children:Object(l.jsx)(s.f,{paddingX:4,paddingY:4,children:Object(l.jsx)(s.cb,{children:t._("Sorry about that. We’ve been notified and will work on a fix! High-five for reporting. ","reportBugSuccess.bodyText","Message shown after submitting a bug report")})})})}var u=i("eOdZ"),p=i("zwad"),b=i("pLLR");const g="success",j="failure",m=e=>Boolean(e.trim()),f={confirmModal:null,imageUrl:null,isSubmitting:!1,uploadFilename:null,uploadPercent:null},h=async(e,t,i)=>{var r;const a=await u.a.create("VIPResource",{upload_ids:[e]}).callGet();if(null!==(r=a.resource_response)&&void 0!==r&&r.data[e]){const r=a.resource_response.data[e],{status:n,signature:o}=r;if("processing"===n||"registered"===n)setTimeout(async()=>{h(e,t,i)},5e3);else if("succeeded"===n){const e=((e,t="1200x")=>e&&`https://i.pinimg.com/${t}/${e.substring(0,2)}/${e.substring(2,4)}/${e.substring(4,6)}/${e}.jpg`||"")(o);t(e)}else i()}else i()};function y({advertiserId:e,onClearModal:t,username:i}){const[n,y]=Object(r.useState)("FEATURE_ERROR"),[O,x]=Object(r.useState)(""),[R,_]=Object(r.useState)(""),{experiments:w}=Object(b.d)(),S=Object(o.c)(),[{confirmModal:v,imageUrl:E,isSubmitting:F,uploadFilename:C,uploadPercent:B},M]=Object(r.useReducer)((e,t)=>{switch(t.type){case"dismissConfirm":return{...e,confirmModal:null};case"reportFailed":return{...e,confirmModal:j,isSubmitting:!1};case"reportSubmitting":return{...e,isSubmitting:!0};case"reportSucceeded":return{...e,confirmModal:g,isSubmitting:!1};case"uploadFailed":const i=S._("Upload failed!","reportBug.uploadFail","bug report image upload failed");return{...f,uploadFilename:i};case"uploadComplete":return{...f,imageUrl:t.payload.imageUrl,uploadFilename:t.payload.filename};case"updateProgress":return{...f,uploadPercent:t.payload};default:throw new Error("action type not supported")}},f),L=[{value:"FEATURE_ERROR",label:S._("Something is broken","reportBug.featureError","Report a broken feature")},{value:"IRRELEVANT_RESULTS",label:S._("Irrelevant search, Pin, or ad","reportBug.irrelevantResults","Report results that are not relevant")},{value:"DESIGN_ERROR",label:S._("Design is wrong","reportBug.designError","Report a design error bug")},{value:"COPY_ERROR",label:S._("Translation or copy is wrong","reportBug.copyError","Report a translation or copy problem")}];let D=null;C?D=C:B&&(D=B+"%");const A=m(R)&&m(O);return Object(l.jsx)("form",{method:"post",onSubmit:t=>{t.preventDefault(),t.stopPropagation(),M({type:"reportSubmitting"});const r=window.navigator.userAgent,o=p.a.getCurrentUrl(),s=w instanceof a.default?JSON.stringify(w.active,null,"\t"):"{}";let l;switch(n){case"FEATURE_ERROR":l="Functionality";break;case"IRRELEVANT_RESULT":l="Relevance";break;case"DESIGN_ERROR":l="Visual";break;case"COPY_ERROR":l="Linguistic";break;default:l="Functionality"}const c={activatedExperiments:s,bugtype:n,description:O,environment:r,platform:"web",title:R,url:o,userImpact:l,username:i,advertiserId:e,image_url:E,filename:C};u.a.create("ReportErrorResource",c).callCreate().then(e=>{e.resource_response.data.errorMessages?M({type:"reportFailed"}):M({type:"reportSucceeded"})}).catch(()=>{M({type:"reportFailed"})})},children:Object(l.jsxs)(s.f,{color:"white",paddingX:4,paddingY:5,children:[Object(l.jsx)(s.f,{display:"flex",justifyContent:"center",padding:4,children:Object(l.jsx)(s.u,{size:"md",children:S._("Report a Bug","label.ReportBugModal","Accessibility label for reporting a bug")})}),Object(l.jsxs)(s.f,{display:"flex",direction:"column",children:[Object(l.jsxs)(s.f,{padding:2,display:"flex",direction:"column",alignItems:"stretch",children:[Object(l.jsx)(s.y,{htmlFor:"bugTitle",children:Object(l.jsx)(s.cb,{children:S._("Description (Required)")})}),Object(l.jsx)(s.f,{paddingY:1,children:Object(l.jsx)(s.eb,{id:"bugTitle",name:"title",onChange:({value:e})=>_(e),type:"text",value:R})})]}),Object(l.jsxs)(s.f,{paddingX:2,paddingY:4,display:"flex",direction:"column",alignItems:"stretch",children:[Object(l.jsx)(s.f,{children:Object(l.jsx)(s.y,{htmlFor:"description",children:Object(l.jsx)(s.cb,{children:S._("Steps to Reproduce (Required)")})})}),Object(l.jsx)(s.f,{paddingY:1,children:Object(l.jsx)(s.db,{id:"description",name:"description",onChange:({value:e})=>x(e),value:O})})]}),Object(l.jsxs)(s.f,{paddingX:2,paddingY:4,display:"flex",direction:"column",alignItems:"stretch",children:[Object(l.jsx)(s.f,{children:Object(l.jsx)(s.y,{htmlFor:"bugtype",children:Object(l.jsx)(s.cb,{children:S._("Type","type as in variety or kind","type as in variety or kind")})})}),Object(l.jsx)(s.f,{paddingY:1,children:Object(l.jsx)(s.S,{id:"bugtype",name:"bugtype",onChange:({value:e})=>y(e),options:L,size:"lg",value:n})})]}),Object(l.jsxs)(s.f,{paddingX:2,paddingY:4,display:"flex",direction:"column",alignItems:"stretch",children:[Object(l.jsx)(s.f,{paddingY:1,children:Object(l.jsx)(s.cb,{children:S._("Attach a Screenshot")})}),Object(l.jsxs)(s.f,{alignItems:"center",direction:"row",display:"flex",children:[Object(l.jsxs)(s.f,{position:"relative",children:[Object(l.jsx)("input",{id:"screenshot-upload-input",onChange:async e=>{const t=e.target.files[0];(new FormData).append("img",t);try{var i;const e=await u.a.create("VIPResource",{type:"pinimage"}).callCreate();if(e&&null!==(i=e.resource_response)&&void 0!==i&&i.data){const{upload_id:i,upload_url:r,upload_parameters:a}=e.resource_response.data,n=new XMLHttpRequest;n.open("POST",r,!0),n.onload=()=>{var e;(e=n.status)>=200&&e<400?h(i,e=>M({type:"uploadComplete",payload:{imageUrl:e,filename:t.name}}),()=>M({type:"uploadFailed"})):M({type:"uploadFailed"})},n.upload.onprogress=e=>{const t=Math.round(99*e.loaded/e.total);M({type:"updateProgress",payload:t})};const o=new FormData;for(const e in a)o.append(e,a[e]);o.append("file",t),n.send(o)}}catch(r){M({type:"uploadFailed"})}},type:"file",style:{cursor:"pointer",height:"100%",left:0,opacity:0,position:"absolute",top:0,width:"100%"},tabIndex:-1}),Object(l.jsx)(s.g,{text:S._("Choose file"),size:"sm",type:"button",color:"gray"})]}),Object(l.jsx)(s.f,{flex:"grow",paddingX:2,children:Object(l.jsx)(s.cb,{size:"md",align:"start",children:D||S._("None")})})]})]})]}),Object(l.jsxs)(s.f,{marginTop:4,children:[Object(l.jsxs)(s.f,{display:"flex",justifyContent:"end",direction:"row",paddingY:2,children:[Object(l.jsx)(s.f,{paddingX:2,children:Object(l.jsx)(s.g,{disabled:!A,text:S._("Report","reportBug.submit","Submit button to report a bug"),type:"submit",color:"red"})}),v===j&&Object(l.jsx)(c,{onDismiss:()=>M({type:"dismissConfirm"})}),v===g&&Object(l.jsx)(d,{onDismiss:t})]}),F&&Object(l.jsx)(s.f,{display:"flex",justifyContent:"end",direction:"row",padding:2,children:Object(l.jsx)(s.cb,{children:S._("Submitting...")})})]})]})})}},f6yG:function(e,t,i){i.r(t),i.d(t,"default",(function(){return l}));var r=i("clxp"),a=i("Ye/N"),n=i("TgLd"),o=i("WxW/"),s=i("nKUr");function l({clearModal:e,username:t}){return Object(s.jsx)(r.a,{name:"CreateMenuModal",children:Object(s.jsx)(n.b,{accessibilityModalLabel:a.a._("Report a Bug","label.ReportBugModal","Accessibility label for reporting a bug"),onDismiss:e,children:Object(s.jsx)(o.default,{onClearModal:e,username:t})})})}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/CreateMenuModalsCommon-8f959d0173eca985ecf0.mjs.map